# ğŸª Hajimi King é¡¹ç›®æ·±åº¦è§£ææ–‡æ¡£

## ç›®å½•

1. [é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡](#1-é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡)
2. [æŠ€æœ¯æ¶æ„è¯¦è§£](#2-æŠ€æœ¯æ¶æ„è¯¦è§£)
3. [æ ¸å¿ƒåŠŸèƒ½æ¨¡å—åˆ†æ](#3-æ ¸å¿ƒåŠŸèƒ½æ¨¡å—åˆ†æ)
4. [å…³é”®ä»£ç å®ç°ä¸æ³¨é‡Š](#4-å…³é”®ä»£ç å®ç°ä¸æ³¨é‡Š)
5. [ç³»ç»Ÿè®¾è®¡æ¨¡å¼ä¸åŸç†](#5-ç³»ç»Ÿè®¾è®¡æ¨¡å¼ä¸åŸç†)
6. [æ•°æ®æµç¨‹å›¾ä¸äº¤äº’é€»è¾‘](#6-æ•°æ®æµç¨‹å›¾ä¸äº¤äº’é€»è¾‘)
7. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#7-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
8. [å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#8-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
9. [æœ€ä½³å®è·µå»ºè®®](#9-æœ€ä½³å®è·µå»ºè®®)
10. [æ‰©å±•å­¦ä¹ èµ„æºæ¨è](#10-æ‰©å±•å­¦ä¹ èµ„æºæ¨è)

---

## 1. é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 é¡¹ç›®èƒŒæ™¯

åœ¨äººå·¥æ™ºèƒ½å¿«é€Ÿå‘å±•çš„ä»Šå¤©ï¼ŒGoogle Gemini API æˆä¸ºäº†å¼€å‘è€…ä»¬é‡è¦çš„å·¥å…·ã€‚ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…åœ¨å…¬å¼€ä»£ç ä»“åº“ä¸­ä¸æ…æš´éœ²äº†ä»–ä»¬çš„ API å¯†é’¥ï¼Œè¿™ä¸ä»…é€ æˆäº†å®‰å…¨éšæ‚£ï¼Œä¹Ÿä¸ºå…¶ä»–å¼€å‘è€…æä¾›äº†"æ„å¤–çš„èµ„æº"ã€‚

**Hajimi King** é¡¹ç›®æ­£æ˜¯åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹è¯ç”Ÿçš„ã€‚é¡¹ç›®åç§°"å“ˆåŸºç±³å¤§ç‹"å¯“æ„ç€"äººäººéƒ½èƒ½æˆä¸ºèµ„æºçš„å‘ç°è€…"ï¼Œä½“ç°äº†é¡¹ç›®çš„æ ¸å¿ƒç†å¿µï¼šé€šè¿‡è‡ªåŠ¨åŒ–æŠ€æœ¯ï¼Œé«˜æ•ˆåœ°å‘ç°å’Œç®¡ç†è¿™äº›å…¬å¼€çš„èµ„æºã€‚

### 1.2 é¡¹ç›®ç›®æ ‡

#### ä¸»è¦ç›®æ ‡
1. **ğŸ” è‡ªåŠ¨åŒ–æœç´¢**ï¼šåœ¨ GitHub ä¸Šè‡ªåŠ¨æœç´¢å¯èƒ½åŒ…å« Gemini API å¯†é’¥çš„ä»£ç æ–‡ä»¶
2. **âœ… æ™ºèƒ½éªŒè¯**ï¼šè‡ªåŠ¨éªŒè¯å‘ç°çš„å¯†é’¥æ˜¯å¦æœ‰æ•ˆ
3. **ğŸ“Š é«˜æ•ˆç®¡ç†**ï¼šå¯¹å‘ç°çš„å¯†é’¥è¿›è¡Œåˆ†ç±»ã€å­˜å‚¨å’Œç®¡ç†
4. **ğŸ”„ å¤–éƒ¨åŒæ­¥**ï¼šå°†æœ‰æ•ˆå¯†é’¥åŒæ­¥åˆ°è´Ÿè½½å‡è¡¡ç³»ç»Ÿ

#### æ¬¡è¦ç›®æ ‡
1. **âš¡ æ€§èƒ½ä¼˜åŒ–**ï¼šé€šè¿‡å¢é‡æ‰«æã€å¤šçº¿ç¨‹ç­‰æŠ€æœ¯æé«˜æ•ˆç‡
2. **ğŸ›¡ï¸ ç¨³å®šè¿è¡Œ**ï¼šé€šè¿‡ä»£ç†è½®æ¢ã€é”™è¯¯é‡è¯•ç­‰æœºåˆ¶ä¿è¯ç¨³å®šæ€§
3. **ğŸ“ˆ å¯æ‰©å±•æ€§**ï¼šé¢„ç•™æ¥å£æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•

### 1.3 é¡¹ç›®ä»·å€¼

- **å¯¹å¼€å‘è€…**ï¼šæä¾›äº†ä¸€ä¸ªå­¦ä¹  GitHub APIã€å¼‚æ­¥ç¼–ç¨‹ã€è®¾è®¡æ¨¡å¼çš„ä¼˜ç§€æ¡ˆä¾‹
- **å¯¹ç¤¾åŒº**ï¼šå¸®åŠ©è¯†åˆ«å’Œç®¡ç†å…¬å¼€çš„ API å¯†é’¥ï¼Œæé«˜æ•´ä½“å®‰å…¨æ„è¯†
- **å¯¹ç ”ç©¶**ï¼šä¸º API å¯†é’¥æ³„éœ²é—®é¢˜çš„ç ”ç©¶æä¾›æ•°æ®æ”¯æŒ

---

## 2. æŠ€æœ¯æ¶æ„è¯¦è§£

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Hajimi King ç³»ç»Ÿ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ä¸»ç¨‹åº    â”‚    â”‚   é…ç½®ç®¡ç†   â”‚    â”‚   æ—¥å¿—ç³»ç»Ÿ   â”‚  â”‚
â”‚  â”‚ hajimi_king â”‚â”€â”€â”€â–¶â”‚    Config    â”‚â—€â”€â”€â”€â”‚    Logger    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å·¥å…·å±‚ (Utils)                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  GitHubå®¢æˆ·ç«¯â”‚  æ–‡ä»¶ç®¡ç†å™¨  â”‚      åŒæ­¥å·¥å…·          â”‚   â”‚
â”‚  â”‚ GitHubClientâ”‚ FileManager  â”‚     SyncUtils          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚              â”‚                    â”‚               â”‚
â”‚         â–¼              â–¼                    â–¼               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ GitHub API  â”‚ â”‚ æœ¬åœ°æ–‡ä»¶ â”‚  â”‚ å¤–éƒ¨è´Ÿè½½å‡è¡¡ç³»ç»Ÿ   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æŠ€æœ¯æ ˆè¯¦è§£

#### 2.2.1 ç¼–ç¨‹è¯­è¨€
- **Python 3.11+**ï¼šé€‰æ‹© Python çš„åŸå› 
  - ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“æ”¯æŒï¼ˆrequestsã€google-generativeaiï¼‰
  - ç®€æ´çš„è¯­æ³•é€‚åˆå¿«é€Ÿå¼€å‘
  - å¼ºå¤§çš„å­—ç¬¦ä¸²å¤„ç†èƒ½åŠ›
  - è‰¯å¥½çš„å¼‚æ­¥ç¼–ç¨‹æ”¯æŒ

#### 2.2.2 æ ¸å¿ƒä¾èµ–åº“

```python
# pyproject.toml ä¸­çš„æ ¸å¿ƒä¾èµ–
dependencies = [
    "google-generativeai>=0.8.5",  # Gemini API å®˜æ–¹å®¢æˆ·ç«¯
    "python-dotenv>=1.1.1",        # ç¯å¢ƒå˜é‡ç®¡ç†
    "requests>=2.32.4",            # HTTP è¯·æ±‚åº“
]
```

#### 2.2.3 å®¹å™¨åŒ–æŠ€æœ¯
- **Docker**ï¼šåº”ç”¨å®¹å™¨åŒ–
- **Docker Compose**ï¼šå®¹å™¨ç¼–æ’
- **ä¼˜åŠ¿**ï¼šç¯å¢ƒä¸€è‡´æ€§ã€éƒ¨ç½²ç®€ä¾¿ã€èµ„æºéš”ç¦»

### 2.3 æ¨¡å—åŒ–è®¾è®¡

é¡¹ç›®é‡‡ç”¨äº†æ¸…æ™°çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€ï¼š

```
é¡¹ç›®ç»“æ„
â”œâ”€â”€ app/                    # åº”ç”¨å±‚
â”‚   â””â”€â”€ hajimi_king.py     # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ common/                 # å…¬å…±å±‚
â”‚   â”œâ”€â”€ config.py          # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ Logger.py          # æ—¥å¿—ç³»ç»Ÿ
â””â”€â”€ utils/                  # å·¥å…·å±‚
    â”œâ”€â”€ file_manager.py    # æ–‡ä»¶æ“ä½œ
    â”œâ”€â”€ github_client.py   # GitHub API å°è£…
    â””â”€â”€ sync_utils.py      # å¤–éƒ¨åŒæ­¥
```

---

## 3. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—åˆ†æ

### 3.1 GitHub æœç´¢æ¨¡å—

#### åŠŸèƒ½æ¦‚è¿°
GitHub æœç´¢æ¨¡å—æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ•°æ®æ¥æºï¼Œè´Ÿè´£ä» GitHub ä¸Šæœç´¢å¯èƒ½åŒ…å« API å¯†é’¥çš„ä»£ç æ–‡ä»¶ã€‚

#### æ ¸å¿ƒç‰¹æ€§
1. **å¤š Token è½®æ¢**ï¼šé¿å…å•ä¸ª Token çš„é€Ÿç‡é™åˆ¶
2. **åˆ†é¡µå¤„ç†**ï¼šæ”¯æŒè·å–æœ€å¤š 1000 ä¸ªæœç´¢ç»“æœ
3. **æ™ºèƒ½é‡è¯•**ï¼šé‡åˆ°é”™è¯¯æ—¶çš„æŒ‡æ•°é€€é¿ç­–ç•¥
4. **ä»£ç†æ”¯æŒ**ï¼šé€šè¿‡ä»£ç†é¿å… IP é™åˆ¶

#### å·¥ä½œæµç¨‹
```
å¼€å§‹æœç´¢
    â”‚
    â–¼
è¯»å–æŸ¥è¯¢è¡¨è¾¾å¼
    â”‚
    â–¼
â”Œâ”€â–¶ æ‰§è¡Œ GitHub æœç´¢ API
â”‚   â”‚
â”‚   â–¼
â”‚  å¤„ç†æœç´¢ç»“æœ
â”‚   â”‚
â”‚   â–¼
â”‚  æ˜¯å¦æœ‰æ›´å¤šé¡µé¢ï¼Ÿ
â”‚   â”‚
â”‚   â”œâ”€æ˜¯â”€â”˜
â”‚   â”‚
â”‚   â””â”€å¦â”€â–¶ è¿”å›æ‰€æœ‰ç»“æœ
```

### 3.2 å¯†é’¥éªŒè¯æ¨¡å—

#### åŠŸèƒ½æ¦‚è¿°
å¯¹æå–å‡ºçš„ç–‘ä¼¼ API å¯†é’¥è¿›è¡Œå®é™…éªŒè¯ï¼Œç¡®è®¤å…¶æœ‰æ•ˆæ€§ã€‚

#### éªŒè¯ç­–ç•¥
```python
def validate_gemini_key(api_key: str) -> Union[bool, str]:
    """
    éªŒè¯ Gemini API å¯†é’¥çš„æœ‰æ•ˆæ€§
    
    è¿”å›å€¼ï¼š
    - "ok": å¯†é’¥æœ‰æ•ˆ
    - "not_authorized_key": å¯†é’¥æ— æ•ˆ
    - "rate_limited": é‡åˆ°é€Ÿç‡é™åˆ¶
    - "disabled": API è¢«ç¦ç”¨
    - "error:xxx": å…¶ä»–é”™è¯¯
    """
```

#### çŠ¶æ€åˆ†ç±»
1. **æœ‰æ•ˆå¯†é’¥**ï¼šå¯ä»¥æ­£å¸¸ä½¿ç”¨çš„å¯†é’¥
2. **æ— æ•ˆå¯†é’¥**ï¼šè®¤è¯å¤±è´¥çš„å¯†é’¥
3. **é™æµå¯†é’¥**ï¼šæš‚æ—¶è¢«é™æµä½†å¯èƒ½æœ‰æ•ˆçš„å¯†é’¥
4. **ç¦ç”¨å¯†é’¥**ï¼šAPI æœåŠ¡è¢«ç¦ç”¨çš„å¯†é’¥

### 3.3 æ–‡ä»¶ç®¡ç†æ¨¡å—

#### åŠŸèƒ½æ¦‚è¿°
è´Ÿè´£æ‰€æœ‰æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ã€ç»“æœæ–‡ä»¶ç­‰ã€‚

#### æ–‡ä»¶ç±»å‹ç®¡ç†
```
data/
â”œâ”€â”€ keys/                      # å¯†é’¥æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ keys_valid_*.txt      # æœ‰æ•ˆå¯†é’¥
â”‚   â”œâ”€â”€ key_429_*.txt         # é™æµå¯†é’¥
â”‚   â””â”€â”€ keys_send_*.txt       # å·²å‘é€å¯†é’¥
â”œâ”€â”€ logs/                      # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ keys_valid_detail_*.log    # è¯¦ç»†æ—¥å¿—
â”‚   â””â”€â”€ key_429_detail_*.log       # é™æµè¯¦ç»†æ—¥å¿—
â”œâ”€â”€ checkpoint.json           # æ£€æŸ¥ç‚¹æ–‡ä»¶
â”œâ”€â”€ scanned_shas.txt         # å·²æ‰«ææ–‡ä»¶è®°å½•
â””â”€â”€ queries.txt              # æœç´¢æŸ¥è¯¢é…ç½®
```

### 3.4 å¢é‡æ‰«ææ¨¡å—

#### åŠŸèƒ½æ¦‚è¿°
é€šè¿‡è®°å½•å·²å¤„ç†çš„æ–‡ä»¶å’ŒæŸ¥è¯¢ï¼Œå®ç°æ–­ç‚¹ç»­ä¼ å’Œå¢é‡æ‰«æåŠŸèƒ½ã€‚

#### æ£€æŸ¥ç‚¹æ•°æ®ç»“æ„
```python
@dataclass
class Checkpoint:
    last_scan_time: Optional[str] = None      # æœ€åæ‰«ææ—¶é—´
    scanned_shas: Set[str] = field(...)       # å·²æ‰«ææ–‡ä»¶ SHA
    processed_queries: Set[str] = field(...)   # å·²å¤„ç†æŸ¥è¯¢
    wait_send_balancer: Set[str] = field(...) # å¾…å‘é€é˜Ÿåˆ—
    wait_send_gpt_load: Set[str] = field(...) # å¾…å‘é€é˜Ÿåˆ—
```

### 3.5 å¤–éƒ¨åŒæ­¥æ¨¡å—

#### åŠŸèƒ½æ¦‚è¿°
å°†å‘ç°çš„æœ‰æ•ˆå¯†é’¥åŒæ­¥åˆ°å¤–éƒ¨è´Ÿè½½å‡è¡¡ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§åŒæ­¥ç›®æ ‡ã€‚

#### åŒæ­¥æ¶æ„
```
å‘ç°æ–°å¯†é’¥
    â”‚
    â–¼
åŠ å…¥åŒæ­¥é˜Ÿåˆ—
    â”‚
    â”œâ”€â”€â–¶ Gemini Balancer é˜Ÿåˆ—
    â”‚
    â””â”€â”€â–¶ GPT Load é˜Ÿåˆ—
         â”‚
         â–¼
    å®šæ—¶æ‰¹é‡å‘é€ï¼ˆ60ç§’ï¼‰
         â”‚
         â–¼
    æ›´æ–°é˜Ÿåˆ—çŠ¶æ€
```

---

## 4. å…³é”®ä»£ç å®ç°ä¸æ³¨é‡Š

### 4.1 å¯†é’¥æå–ç®—æ³•

```python
def extract_keys_from_content(content: str) -> List[str]:
    """
    ä»æ–‡ä»¶å†…å®¹ä¸­æå– Gemini API å¯†é’¥
    
    Gemini API å¯†é’¥æ ¼å¼ï¼šAIzaSy + 33ä¸ªå­—ç¬¦
    æ€»é•¿åº¦ï¼š39ä¸ªå­—ç¬¦
    
    Args:
        content: æ–‡ä»¶å†…å®¹
        
    Returns:
        List[str]: æå–å‡ºçš„å¯†é’¥åˆ—è¡¨
    """
    # æ­£åˆ™è¡¨è¾¾å¼è§£é‡Šï¼š
    # AIzaSy: å›ºå®šå‰ç¼€
    # [A-Za-z0-9\-_]{33}: 33ä¸ªå­—ç¬¦ï¼ŒåŒ…å«å­—æ¯ã€æ•°å­—ã€æ¨ªçº¿ã€ä¸‹åˆ’çº¿
    pattern = r'(AIzaSy[A-Za-z0-9\-_]{33})'
    return re.findall(pattern, content)
```

### 4.2 æ™ºèƒ½è¿‡æ»¤å®ç°

```python
def should_skip_item(item: Dict[str, Any], checkpoint: Checkpoint) -> tuple[bool, str]:
    """
    åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡å¤„ç†æŸä¸ªæ–‡ä»¶
    
    è·³è¿‡æ¡ä»¶ï¼š
    1. æ—¶é—´è¿‡æ»¤ï¼šä»“åº“æ›´æ–°æ—¶é—´æ—©äºä¸Šæ¬¡æ‰«ææ—¶é—´
    2. SHA å»é‡ï¼šæ–‡ä»¶å·²ç»è¢«æ‰«æè¿‡
    3. å¹´é¾„è¿‡æ»¤ï¼šä»“åº“å¤ªæ—§ï¼ˆé»˜è®¤ 2 å¹´ï¼‰
    4. æ–‡æ¡£è¿‡æ»¤ï¼šæ–‡æ¡£ã€ç¤ºä¾‹ã€æµ‹è¯•æ–‡ä»¶
    
    Returns:
        tuple: (æ˜¯å¦è·³è¿‡, è·³è¿‡åŸå› )
    """
    # å¢é‡æ‰«ææ—¶é—´æ£€æŸ¥
    if checkpoint.last_scan_time:
        try:
            last_scan_dt = datetime.fromisoformat(checkpoint.last_scan_time)
            repo_pushed_at = item["repository"].get("pushed_at")
            if repo_pushed_at:
                repo_pushed_dt = datetime.strptime(repo_pushed_at, "%Y-%m-%dT%H:%M:%SZ")
                if repo_pushed_dt <= last_scan_dt:
                    skip_stats["time_filter"] += 1
                    return True, "time_filter"
        except Exception:
            pass
    
    # SHA å»é‡æ£€æŸ¥
    if item.get("sha") in checkpoint.scanned_shas:
        skip_stats["sha_duplicate"] += 1
        return True, "sha_duplicate"
    
    # ä»“åº“å¹´é¾„æ£€æŸ¥
    repo_pushed_at = item["repository"].get("pushed_at")
    if repo_pushed_at:
        repo_pushed_dt = datetime.strptime(repo_pushed_at, "%Y-%m-%dT%H:%M:%SZ")
        if repo_pushed_dt < datetime.utcnow() - timedelta(days=Config.DATE_RANGE_DAYS):
            skip_stats["age_filter"] += 1
            return True, "age_filter"
    
    # æ–‡æ¡£æ–‡ä»¶è¿‡æ»¤
    lowercase_path = item["path"].lower()
    if any(token in lowercase_path for token in Config.FILE_PATH_BLACKLIST):
        skip_stats["doc_filter"] += 1
        return True, "doc_filter"
    
    return False, ""
```

### 4.3 ä»£ç†è½®æ¢æœºåˆ¶

```python
@classmethod
def get_random_proxy(cls) -> Optional[Dict[str, str]]:
    """
    éšæœºè·å–ä¸€ä¸ªä»£ç†é…ç½®
    
    æ”¯æŒçš„ä»£ç†æ ¼å¼ï¼š
    - http://host:port
    - http://user:pass@host:port
    - socks5://host:port
    
    Returns:
        Optional[Dict[str, str]]: requests æ ¼å¼çš„ proxies å­—å…¸
    """
    if not cls.PROXY_LIST:
        return None
    
    # éšæœºé€‰æ‹©ä¸€ä¸ªä»£ç†
    proxy_url = random.choice(cls.PROXY_LIST).strip()
    
    # è¿”å› requests æ ¼å¼çš„ proxies å­—å…¸
    return {
        'http': proxy_url,
        'https': proxy_url
    }
```

### 4.4 å¼‚æ­¥åŒæ­¥å®ç°

```python
def _start_batch_sender(self) -> None:
    """
    å¯åŠ¨æ‰¹é‡å‘é€å®šæ—¶å™¨
    
    å·¥ä½œåŸç†ï¼š
    1. ä½¿ç”¨ ThreadPoolExecutor æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡
    2. ä½¿ç”¨ Timer å®ç°å®šæ—¶è§¦å‘
    3. æ‰¹é‡å¤„ç†æé«˜æ•ˆç‡
    """
    if self.shutdown_flag:
        return
    
    # å¯åŠ¨å‘é€ä»»åŠ¡
    self.executor.submit(self._batch_send_worker)
    
    # è®¾ç½®ä¸‹ä¸€æ¬¡å‘é€å®šæ—¶å™¨
    self.batch_timer = threading.Timer(self.batch_interval, self._start_batch_sender)
    self.batch_timer.daemon = True
    self.batch_timer.start()
```

---

## 5. ç³»ç»Ÿè®¾è®¡æ¨¡å¼ä¸åŸç†

### 5.1 è®¾è®¡æ¨¡å¼åº”ç”¨

#### 5.1.1 å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰
```python
# å…¨å±€é…ç½®å®ä¾‹
config = Config()

# å…¨å±€æ–‡ä»¶ç®¡ç†å™¨å®ä¾‹
file_manager = FileManager(Config.DATA_PATH)

# å…¨å±€åŒæ­¥å·¥å…·å®ä¾‹
sync_utils = SyncUtils()
```

**åº”ç”¨åœºæ™¯**ï¼šç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œé¿å…èµ„æºæµªè´¹å’ŒçŠ¶æ€ä¸ä¸€è‡´ã€‚

#### 5.1.2 å·¥å‚æ¨¡å¼ï¼ˆFactoryï¼‰
```python
@staticmethod
def create_instance(tokens: List[str]) -> 'GitHubClient':
    """å·¥å‚æ–¹æ³•åˆ›å»º GitHub å®¢æˆ·ç«¯å®ä¾‹"""
    return GitHubClient(tokens)
```

**åº”ç”¨åœºæ™¯**ï¼šå°è£…å¯¹è±¡åˆ›å»ºé€»è¾‘ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤ã€‚

#### 5.1.3 ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰
```python
# ä¸åŒçš„å¯†é’¥éªŒè¯ç»“æœå¯¹åº”ä¸åŒçš„å¤„ç†ç­–ç•¥
validation_result = validate_gemini_key(key)
if validation_result and "ok" in validation_result:
    # æœ‰æ•ˆå¯†é’¥å¤„ç†ç­–ç•¥
    valid_keys.append(key)
elif validation_result == "rate_limited":
    # é™æµå¯†é’¥å¤„ç†ç­–ç•¥
    rate_limited_keys.append(key)
else:
    # æ— æ•ˆå¯†é’¥å¤„ç†ç­–ç•¥
    logger.info(f"âŒ INVALID: {key}")
```

### 5.2 æ¶æ„åŸåˆ™

#### 5.2.1 å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰
æ¯ä¸ªæ¨¡å—å’Œç±»éƒ½æœ‰æ˜ç¡®çš„å•ä¸€èŒè´£ï¼š
- `GitHubClient`ï¼šåªè´Ÿè´£ GitHub API äº¤äº’
- `FileManager`ï¼šåªè´Ÿè´£æ–‡ä»¶æ“ä½œ
- `SyncUtils`ï¼šåªè´Ÿè´£å¤–éƒ¨åŒæ­¥

#### 5.2.2 å¼€é—­åŸåˆ™ï¼ˆOCPï¼‰
ç³»ç»Ÿå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼š
- æ–°å¢åŒæ­¥ç›®æ ‡åªéœ€åœ¨ `SyncUtils` ä¸­æ·»åŠ æ–°æ–¹æ³•
- æ–°å¢æ–‡ä»¶ç±»å‹åªéœ€åœ¨ `FileManager` ä¸­æ·»åŠ æ–°æ–¹æ³•

#### 5.2.3 ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰
é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½ä¾èµ–æŠ½è±¡ï¼š
- ä¸»ç¨‹åºä¾èµ–é…ç½®æŠ½è±¡ï¼Œè€Œä¸æ˜¯å…·ä½“çš„é…ç½®æ–‡ä»¶
- å·¥å…·ç±»ä¾èµ–æ¥å£å®šä¹‰ï¼Œè€Œä¸æ˜¯å…·ä½“å®ç°

### 5.3 å¹¶å‘è®¾è®¡

#### 5.3.1 çº¿ç¨‹æ± æ¨¡å‹
```python
# åˆ›å»ºçº¿ç¨‹æ± ç”¨äºå¼‚æ­¥æ‰§è¡Œ
self.executor = ThreadPoolExecutor(
    max_workers=2,
    thread_name_prefix="SyncUtils"
)
```

#### 5.3.2 é”æœºåˆ¶
```python
# ä½¿ç”¨æ ‡å¿—ä½ä½œä¸ºç®€å•é”
while self.saving_checkpoint:
    logger.info("ç­‰å¾…æ£€æŸ¥ç‚¹ä¿å­˜å®Œæˆ...")
    time.sleep(0.5)

self.saving_checkpoint = True
try:
    # ä¸´ç•ŒåŒºä»£ç 
    file_manager.save_checkpoint(checkpoint)
finally:
    self.saving_checkpoint = False
```

---

## 6. æ•°æ®æµç¨‹å›¾ä¸äº¤äº’é€»è¾‘

### 6.1 ä¸»æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¯åŠ¨ç¨‹åº   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŠ è½½é…ç½®   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŠ è½½æ£€æŸ¥ç‚¹  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯»å–æŸ¥è¯¢åˆ—è¡¨ â”‚â”€â”€â”€â”€â–¶â”‚ æ‰§è¡Œæœç´¢æŸ¥è¯¢ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â–²                    â”‚
       â”‚                    â–¼
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚            â”‚ è·å–æœç´¢ç»“æœ â”‚
       â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚            â”‚  è¿‡æ»¤æ–‡ä»¶   â”‚
       â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚            â”‚ æå–APIå¯†é’¥ â”‚
       â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚            â”‚  éªŒè¯å¯†é’¥   â”‚
       â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚            â”‚  ä¿å­˜ç»“æœ   â”‚
       â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚            â”‚ æ›´æ–°æ£€æŸ¥ç‚¹  â”‚
       â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 å¯†é’¥éªŒè¯æµç¨‹

```
æå–åˆ°å¯†é’¥
    â”‚
    â–¼
é…ç½®ä»£ç†ï¼ˆå¦‚æœæœ‰ï¼‰
    â”‚
    â–¼
è°ƒç”¨ Gemini API
    â”‚
    â”œâ”€æˆåŠŸâ”€â–¶ è¿”å› "ok"
    â”‚
    â”œâ”€401/403â”€â–¶ è¿”å› "not_authorized_key"
    â”‚
    â”œâ”€429â”€â–¶ è¿”å› "rate_limited"
    â”‚
    â””â”€å…¶ä»–é”™è¯¯â”€â–¶ è¿”å› "error:xxx"
```

### 6.3 å¤–éƒ¨åŒæ­¥æµç¨‹

```
å‘ç°æœ‰æ•ˆå¯†é’¥
    â”‚
    â–¼
åŠ å…¥å¾…å‘é€é˜Ÿåˆ—
    â”‚
    â”œâ”€â”€â–¶ wait_send_balancer
    â”‚
    â””â”€â”€â–¶ wait_send_gpt_load
         â”‚
         â–¼
    å®šæ—¶å™¨è§¦å‘ï¼ˆ60ç§’ï¼‰
         â”‚
         â–¼
    æ‰¹é‡å‘é€ä»»åŠ¡
         â”‚
         â”œâ”€â”€â–¶ å‘é€åˆ° Gemini Balancer
         â”‚    â”‚
         â”‚    â”œâ”€æˆåŠŸâ”€â–¶ æ¸…ç©ºé˜Ÿåˆ—
         â”‚    â”‚
         â”‚    â””â”€å¤±è´¥â”€â–¶ ä¿ç•™é˜Ÿåˆ—
         â”‚
         â””â”€â”€â–¶ å‘é€åˆ° GPT Load
              â”‚
              â”œâ”€æˆåŠŸâ”€â–¶ æ¸…ç©ºé˜Ÿåˆ—
              â”‚
              â””â”€å¤±è´¥â”€â–¶ ä¿ç•™é˜Ÿåˆ—
```

### 6.4 æ•°æ®å­˜å‚¨ç»“æ„

```
æ£€æŸ¥ç‚¹æ•°æ®ï¼ˆcheckpoint.jsonï¼‰
{
    "last_scan_time": "2024-01-01T00:00:00",
    "processed_queries": ["AIzaSy in:file", ...],
    "wait_send_balancer": ["AIzaSy...", ...],
    "wait_send_gpt_load": ["AIzaSy...", ...]
}

å·²æ‰«ææ–‡ä»¶ï¼ˆscanned_shas.txtï¼‰
# å·²æ‰«æçš„æ–‡ä»¶SHAåˆ—è¡¨
# æ¯è¡Œä¸€ä¸ªSHAï¼Œç”¨äºé¿å…é‡å¤æ‰«æ
# æœ€åæ›´æ–°æ—¶é—´: 2024-01-01 00:00:00

abc123def456...
def456ghi789...
```

---

## 7. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 7.1 æœç´¢ä¼˜åŒ–

#### 7.1.1 æŸ¥è¯¢è¡¨è¾¾å¼ä¼˜åŒ–
```python
def normalize_query(query: str) -> str:
    """
    æ ‡å‡†åŒ–æŸ¥è¯¢è¡¨è¾¾å¼ï¼Œæé«˜ç¼“å­˜å‘½ä¸­ç‡
    
    ä¼˜åŒ–ç­–ç•¥ï¼š
    1. ç»Ÿä¸€ç©ºæ ¼å¤„ç†
    2. å‚æ•°æ’åº
    3. å¼•å·æ ‡å‡†åŒ–
    """
```

**æ•ˆæœ**ï¼šç›¸åŒè¯­ä¹‰çš„æŸ¥è¯¢ä¼šè¢«æ ‡å‡†åŒ–ä¸ºç›¸åŒå­—ç¬¦ä¸²ï¼Œæé«˜ç¼“å­˜æ•ˆç‡ã€‚

#### 7.1.2 åˆ†é¡µå¹¶å‘æ§åˆ¶
```python
# æ¯å¤„ç† 20 ä¸ªæ–‡ä»¶ä¿å­˜ä¸€æ¬¡æ£€æŸ¥ç‚¹
if item_index % 20 == 0:
    logger.info(f"ğŸ“ˆ Progress: {item_index}/{len(items)}")
    file_manager.save_checkpoint(checkpoint)
```

**æ•ˆæœ**ï¼šé¿å…å¤§é‡æ•°æ®ä¸¢å¤±ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ ã€‚

### 7.2 ç½‘ç»œä¼˜åŒ–

#### 7.2.1 Token è½®æ¢
```python
def _next_token(self) -> Optional[str]:
    """è½®æ¢ä½¿ç”¨å¤šä¸ª GitHub Tokenï¼Œé¿å…å•ä¸ª Token é™æµ"""
    token = self.tokens[self._token_ptr % len(self.tokens)]
    self._token_ptr += 1
    return token
```

**æ•ˆæœ**ï¼šå°† API é™åˆ¶åˆ†æ•£åˆ°å¤šä¸ª Tokenï¼Œæé«˜æ•´ä½“ååé‡ã€‚

#### 7.2.2 ä»£ç†æ± 
```python
# éšæœºé€‰æ‹©ä»£ç†ï¼Œé¿å…å•ä¸ª IP è¢«é™åˆ¶
proxies = Config.get_random_proxy()
```

**æ•ˆæœ**ï¼šé¿å… IP é™åˆ¶ï¼Œæé«˜è¯·æ±‚æˆåŠŸç‡ã€‚

### 7.3 å­˜å‚¨ä¼˜åŒ–

#### 7.3.1 å¢é‡æ‰«æ
```python
# åªå¤„ç†æ›´æ–°æ—¶é—´æ™šäºä¸Šæ¬¡æ‰«æçš„ä»“åº“
if repo_pushed_dt <= last_scan_dt:
    return True, "time_filter"
```

**æ•ˆæœ**ï¼šé¿å…é‡å¤å¤„ç†ï¼Œå¤§å¹…å‡å°‘æ‰«æé‡ã€‚

#### 7.3.2 SHA å»é‡
```python
# ä½¿ç”¨ Set æ•°æ®ç»“æ„å¿«é€Ÿåˆ¤æ–­
if item.get("sha") in checkpoint.scanned_shas:
    return True, "sha_duplicate"
```

**æ•ˆæœ**ï¼šO(1) æ—¶é—´å¤æ‚åº¦çš„å»é‡åˆ¤æ–­ã€‚

### 7.4 å¹¶å‘ä¼˜åŒ–

#### 7.4.1 å¼‚æ­¥åŒæ­¥
```python
# ä½¿ç”¨çº¿ç¨‹æ± å¼‚æ­¥å‘é€ï¼Œä¸é˜»å¡ä¸»æµç¨‹
self.executor.submit(self._batch_send_worker)
```

**æ•ˆæœ**ï¼šä¸»æ‰«ææµç¨‹ä¸å—åŒæ­¥æ“ä½œå½±å“ã€‚

#### 7.4.2 æ‰¹é‡å¤„ç†
```python
# æ‰¹é‡å‘é€ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°
self.batch_interval = 60  # 60ç§’æ‰¹é‡å‘é€ä¸€æ¬¡
```

**æ•ˆæœ**ï¼šå‡å°‘ HTTP è¯·æ±‚æ¬¡æ•°ï¼Œæé«˜æ•ˆç‡ã€‚

### 7.5 å†…å­˜ä¼˜åŒ–

#### 7.5.1 æµå¼å¤„ç†
```python
# é€ä¸ªå¤„ç†æœç´¢ç»“æœï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§åŠ è½½
for item in items:
    process_item(item)
```

**æ•ˆæœ**ï¼šé¿å…å¤§é‡æ•°æ®å ç”¨å†…å­˜ã€‚

#### 7.5.2 åŠæ—¶æ¸…ç†
```python
# å¤„ç†å®Œæˆåæ¸…ç©ºé˜Ÿåˆ—
checkpoint.wait_send_balancer.clear()
```

**æ•ˆæœ**ï¼šåŠæ—¶é‡Šæ”¾å†…å­˜ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚

---

## 8. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 8.1 GitHub API é™åˆ¶é—®é¢˜

**é—®é¢˜æè¿°**ï¼š
GitHub API æœ‰é€Ÿç‡é™åˆ¶ï¼Œæœªè®¤è¯ç”¨æˆ·æ¯å°æ—¶ 60 æ¬¡ï¼Œè®¤è¯ç”¨æˆ·æ¯å°æ—¶ 5000 æ¬¡ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **å¤š Token è½®æ¢**
```python
# é…ç½®å¤šä¸ª Token
GITHUB_TOKENS=ghp_token1,ghp_token2,ghp_token3
```

2. **æ™ºèƒ½é‡è¯•**
```python
# é‡åˆ° 429 é”™è¯¯æ—¶æŒ‡æ•°é€€é¿
wait = min(2 ** attempt + random.uniform(0, 1), 60)
time.sleep(wait)
```

3. **å¢é‡æ‰«æ**
```python
# åªæ‰«ææ–°æ›´æ–°çš„ä»“åº“
if repo_pushed_dt <= last_scan_dt:
    skip_stats["time_filter"] += 1
    return True, "time_filter"
```

### 8.2 ä»£ç†è¿æ¥é—®é¢˜

**é—®é¢˜æè¿°**ï¼š
ä½¿ç”¨ä»£ç†æ—¶å¯èƒ½é‡åˆ°è¿æ¥å¤±è´¥ã€è¶…æ—¶ç­‰é—®é¢˜ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **ä»£ç†æ± è½®æ¢**
```python
# é…ç½®å¤šä¸ªä»£ç†
PROXY=http://proxy1:8080,http://proxy2:8080,socks5://proxy3:1080
```

2. **å¼‚å¸¸å¤„ç†**
```python
try:
    response = requests.get(url, proxies=proxies, timeout=30)
except requests.exceptions.ProxyError:
    # åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªä»£ç†
    proxies = Config.get_random_proxy()
```

### 8.3 å†…å­˜å ç”¨é—®é¢˜

**é—®é¢˜æè¿°**ï¼š
é•¿æ—¶é—´è¿è¡Œåå†…å­˜å ç”¨æŒç»­å¢é•¿ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **å®šæœŸä¿å­˜å’Œæ¸…ç†**
```python
# æ¯ 20 ä¸ªæ–‡ä»¶ä¿å­˜ä¸€æ¬¡
if item_index % 20 == 0:
    file_manager.save_checkpoint(checkpoint)
    file_manager.update_dynamic_filenames()
```

2. **ä½¿ç”¨ç”Ÿæˆå™¨**
```python
# ä½¿ç”¨ç”Ÿæˆå™¨è€Œä¸æ˜¯åˆ—è¡¨
def get_items():
    for page in range(1, 11):
        items = fetch_page(page)
        yield from items
```

### 8.4 å¯†é’¥éªŒè¯å¤±è´¥

**é—®é¢˜æè¿°**ï¼š
æœ‰æ•ˆçš„å¯†é’¥è¢«è¯¯åˆ¤ä¸ºæ— æ•ˆã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **é‡è¯•æœºåˆ¶**
```python
# æ·»åŠ éšæœºå»¶è¿Ÿé¿å…å¹¶å‘é™åˆ¶
time.sleep(random.uniform(0.5, 1.5))
```

2. **åˆ†ç±»å¤„ç†**
```python
# åŒºåˆ†ä¸åŒçš„å¤±è´¥åŸå› 
if "429" in str(e):
    return "rate_limited"
elif "403" in str(e):
    return "disabled"
```

### 8.5 Docker éƒ¨ç½²é—®é¢˜

**é—®é¢˜æè¿°**ï¼š
Docker å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨æˆ–è¿è¡Œã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **æ£€æŸ¥é…ç½®**
```bash
# ç¡®ä¿ .env æ–‡ä»¶å­˜åœ¨ä¸”é…ç½®æ­£ç¡®
cp env.example .env
vim .env